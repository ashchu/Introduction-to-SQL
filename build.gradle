
buildscript {
    dependencies {
        classpath 'com.h2database:h2:1.4.196'
    }
}

plugins {
    id 'java'
    id "org.flywaydb.flyway" version "4.2.0"
}

repositories {
    mavenCentral()
		jcenter()
}

dependencies {
  runtime 'com.h2database:h2:1.4.196'
}

flyway {
    url = 'jdbc:h2:file:./build/introduction_to_sql;FILE_LOCK=NO'
		user = 'sa'
}

task startDatabase(type: JavaExec) {
  workingDir = projectDir
	classpath = sourceSets.main.runtimeClasspath	
  main = 'org.h2.tools.Server'
	args '-properties', '.'
}

def buildAliases = [
   'run' : ['flywayMigrate', 'startDatabase'],
   'rebuild' : ['clean', 'flywayMigrate']
]
def expandedTaskList = []
 
gradle.startParameter.taskNames.each {
   expandedTaskList << (buildAliases[it] ? buildAliases[it] : it)
}
 
gradle.startParameter.taskNames = expandedTaskList.flatten()
